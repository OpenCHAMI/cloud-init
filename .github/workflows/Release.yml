name: Release with goreleaser

on:
  workflow_dispatch:
  push:
    tags:
      - v*

jobs:
  release:
    uses: OpenCHAMI/github-actions/workflows/go-build-release.yml@v2
    with:
      cgo-enabled: "0"
      pre-build-commands: |
        go install github.com/swaggo/swag/cmd/swag@latest
      attestation-binary-path: "dist/cloud-init*"
      registry-name: ghcr.io/openchami/cloud-init
